# 用户管理系统需求分析

## 📋 项目概述

### 🎯 学习目标
通过本项目，你将学会开发一个**企业级用户管理系统**，掌握：
- Spring Boot后端开发
- MySQL数据库设计
- JWT认证机制
- RBAC权限模型
- RESTful API设计
- 自动化测试

### 🏗️ 最终系统架构
你将要构建的系统包含：
- **后端**: Spring Boot + MySQL + JWT认证
- **数据库**: 14张表，完整的用户权限体系
- **API**: RESTful接口，统一响应格式
- **测试**: 自动化测试覆盖所有核心功能

### 📊 预期成果
完成后的系统将包含：
- **用户管理**: 支持注册、登录、个人信息管理
- **角色系统**: 5种用户角色，灵活的权限分配
- **权限控制**: 28个细粒度权限，7个功能模块
- **团队协作**: 团队创建、成员管理、权限继承

## 👥 用户角色设计

### 🔴 超级管理员 (Super Admin)
- **数量**: 1个 (系统初始化时创建)
- **权限**: 系统所有功能的完全访问权限
- **职责**: 系统初始化、全局配置管理、紧急问题处理
- **典型用户**: admin@devops2025.com

### 🟡 系统管理员 (System Admin)
- **权限**: 用户管理、角色管理、系统监控
- **职责**: 日常系统管理和维护
- **使用场景**: 创建用户账户、分配角色、监控系统状态

### 🟢 团队负责人 (Team Leader)
- **权限**: 团队创建、成员管理、团队权限配置
- **职责**: 团队建设和管理
- **使用场景**: 创建项目团队、邀请成员、分配团队内角色

### 🔵 团队管理员 (Team Admin)
- **权限**: 团队成员管理、部分团队配置
- **职责**: 协助团队负责人管理团队
- **使用场景**: 审核成员申请、管理团队日常事务

### ⚪ 普通用户 (Regular User)
- **权限**: 个人信息管理、基础功能使用
- **职责**: 系统的基础使用者
- **使用场景**: 注册登录、修改个人信息、使用业务功能

## 🚀 核心功能需求

### 1️⃣ 用户认证模块

#### 📝 用户注册功能
**用户故事**: 作为新用户，我希望能够注册账户，以便开始使用系统

**功能要求**:
- 支持邮箱+密码注册
- 邮箱格式验证和唯一性检查
- 密码强度验证（至少8位，包含字母数字）
- 注册成功后自动分配"普通用户"角色
- 返回注册成功确认信息

**验收标准**:
- ✅ 邮箱格式正确且未被使用
- ✅ 密码符合安全要求
- ✅ 用户信息正确保存到数据库
- ✅ 自动分配默认角色

#### 🔐 用户登录功能
**用户故事**: 作为注册用户，我希望能够安全登录，以便访问系统功能

**功能要求**:
- 支持用户名/邮箱+密码登录
- JWT Token生成和管理
- Token有效期控制（24小时）
- 登录失败次数限制
- 安全的密码验证

**验收标准**:
- ✅ 用户凭据验证正确
- ✅ 生成有效的JWT Token
- ✅ Token包含用户身份和权限信息
- ✅ 登录状态正确维护

#### 🚪 安全登出功能
**用户故事**: 作为登录用户，我希望能够安全登出，以便保护账户安全

**功能要求**:
- 清除客户端Token
- 服务端Token失效处理
- 登出后访问控制验证

### 2️⃣ 用户管理模块

#### 👤 个人资料管理
**用户故事**: 作为用户，我希望能够查看和更新个人信息

**功能要求**:
- 查看个人基本信息
- 更新昵称、邮箱等信息
- 头像上传功能
- 权限控制（只能管理自己的信息）

#### 🔑 密码管理
**用户故事**: 作为用户，我希望能够修改密码，以便保护账户安全

**功能要求**:
- 当前密码验证
- 新密码强度检查
- 新密码确认验证
- 密码加密存储

### 3️⃣ 权限管理模块

#### 🎭 角色管理
**用户故事**: 作为管理员，我希望能够管理系统角色，以便控制用户权限

**功能要求**:
- 角色的增删改查
- 角色权限分配
- 角色信息查询
- 角色使用统计

**预设角色**:
1. 超级管理员 - 系统最高权限
2. 系统管理员 - 系统管理权限
3. 团队负责人 - 团队创建和管理
4. 团队管理员 - 团队协助管理
5. 普通用户 - 基础使用权限

#### 🔒 权限管理
**用户故事**: 作为管理员，我希望能够管理系统权限，以便精确控制功能访问

**功能要求**:
- 权限的增删改查
- 权限模块分类管理
- 权限验证机制
- 权限分配给角色

**权限模块设计**:
- **用户模块**: 用户查看、创建、更新、删除
- **角色模块**: 角色管理、权限分配
- **权限模块**: 权限CRUD、模块管理
- **团队模块**: 团队管理、成员管理
- **系统模块**: 系统配置、监控管理

### 4️⃣ 系统管理模块

#### 📊 数据统计
**用户故事**: 作为管理员，我希望能够查看系统统计信息

**功能要求**:
- 用户数量统计
- 角色分布统计
- 权限使用情况
- 系统健康状态监控


## 🎯 学习成果验证

完成本项目后，你将能够：
- ✅ 独立搭建Spring Boot项目
- ✅ 设计完整的数据库表结构
- ✅ 实现JWT认证机制
- ✅ 构建RBAC权限模型
- ✅ 开发RESTful API接口
- ✅ 编写自动化测试脚本
- ✅ 部署运行完整系统

**最终验收标准**: 系统能够支持用户注册登录、角色权限管理、团队协作等功能，所有API接口正常工作，自动化测试通过率100%。

## 用户故事

### 3.1 用户注册相关故事

**故事1**: 作为一个**游客**，我希望能够通过邮箱注册账户，以便我可以使用系统的各项功能。
- **验收标准**:
  - 我可以输入用户名、邮箱、密码来注册
  - 系统会验证邮箱格式的正确性
  - 用户名和邮箱必须是唯一的
  - 密码需要满足安全要求（8-20字符，包含字母数字）
  - 注册成功后我会收到邮箱验证链接

**故事2**: 作为一个**游客**，我希望能够通过手机号注册账户，以便我有多种注册方式选择。
- **验收标准**:
  - 我可以选择手机号注册方式
  - 系统会发送短信验证码到我的手机
  - 验证码5分钟内有效
  - 手机号必须是唯一的

**故事3**: 作为一个**游客**，我希望在注册时看到图形验证码，以防止机器人恶意注册。
- **验收标准**:
  - 注册页面显示图形验证码
  - 验证码输入错误时会刷新
  - 必须正确输入验证码才能提交注册

### 3.2 用户登录相关故事

**故事4**: 作为一个**已注册用户**，我希望能够通过邮箱和密码登录，以便访问我的账户。
- **验收标准**:
  - 我可以输入邮箱和密码进行登录
  - 登录成功后跳转到主页面
  - 登录失败时显示明确的错误信息
  - 系统记录我的登录日志

**故事5**: 作为一个**已注册用户**，我希望能够通过用户名和密码登录，以便我有多种登录方式。
- **验收标准**:
  - 我可以选择用户名登录方式
  - 登录逻辑与邮箱登录相同
  - 支持记住登录状态功能

**故事6**: 作为一个**已注册用户**，我希望能够通过手机号和短信验证码登录，以便在忘记密码时也能登录。
- **验收标准**:
  - 我可以选择手机号+验证码登录
  - 系统发送验证码到我的手机
  - 验证码5分钟内有效
  - 验证成功后自动登录

**故事7**: 作为一个**已注册用户**，我希望在多次登录失败后账户被临时锁定，以保护我的账户安全。
- **验收标准**:
  - 连续5次登录失败后账户锁定30分钟
  - 锁定期间显示剩余时间
  - 锁定期间无法尝试登录

**故事8**: 作为一个**已注册用户**，我希望能够重置忘记的密码，以便重新获得账户访问权限。
- **验收标准**:
  - 我可以通过邮箱重置密码
  - 我可以通过手机号重置密码
  - 重置链接/验证码有时效性
  - 重置成功后旧密码失效

### 3.3 用户个人中心相关故事

**故事9**: 作为一个**普通用户**，我希望能够查看和编辑我的个人资料，以便保持信息的准确性。
- **验收标准**:
  - 我可以查看我的基本信息（用户名、邮箱、手机号等）
  - 我可以编辑昵称、头像、个人简介
  - 我可以修改登录密码
  - 我可以绑定或解绑手机号、邮箱

**故事10**: 作为一个**普通用户**，我希望能够查看我的登录历史，以便监控账户安全。
- **验收标准**:
  - 我可以看到最近的登录记录
  - 记录包含登录时间、IP地址、设备信息
  - 我可以远程登出其他设备
  - 发现异常登录时可以及时处理

### 3.4 RBAC权限管理相关故事

**故事11**: 作为一个**系统管理员**，我希望能够创建和管理角色，以便灵活分配权限。
- **验收标准**:
  - 我可以创建新的角色
  - 我可以为角色分配具体权限
  - 我可以编辑或删除角色
  - 我可以查看角色的权限列表

**故事12**: 作为一个**系统管理员**，我希望能够为用户分配角色，以便控制用户的访问权限。
- **验收标准**:
  - 我可以查看用户列表
  - 我可以为用户分配一个或多个角色
  - 我可以移除用户的角色
  - 角色变更立即生效

**故事13**: 作为一个**普通用户**，我希望系统根据我的角色显示相应的菜单和功能，以便我只看到有权限的内容。
- **验收标准**:
  - 菜单根据我的权限动态显示
  - 无权限的按钮和操作被隐藏或禁用
  - 尝试访问无权限页面时显示友好提示
  - 权限变更后界面自动更新

### 3.5 团队管理相关故事

**故事14**: 作为一个**普通用户**，我希望能够创建团队，以便组织和管理项目成员。
- **验收标准**:
  - 我可以创建新团队并设置团队名称
  - 我可以添加团队描述和头像
  - 我可以设置团队为公开或私有
  - 创建成功后我自动成为团队负责人

**故事15**: 作为一个**团队负责人**，我希望能够邀请其他用户加入我的团队，以便扩大团队规模。
- **验收标准**:
  - 我可以通过邮箱邀请用户
  - 我可以通过用户名搜索并邀请用户
  - 我可以生成邀请链接分享给他人
  - 我可以设置邀请链接的过期时间

**故事16**: 作为一个**普通用户**，我希望能够搜索并申请加入公开团队，以便参与感兴趣的项目。
- **验收标准**:
  - 我可以搜索公开的团队
  - 我可以查看团队的基本信息
  - 我可以申请加入团队
  - 我可以查看申请状态

**故事17**: 作为一个**团队管理员**，我希望能够审批加入申请，以便控制团队成员质量。
- **验收标准**:
  - 我可以查看待审批的申请列表
  - 我可以查看申请者的基本信息
  - 我可以批准或拒绝申请
  - 申请者会收到审批结果通知

**故事18**: 作为一个**团队负责人**，我希望能够管理团队成员的角色和权限，以便合理分工。
- **验收标准**:
  - 我可以查看团队成员列表
  - 我可以设置成员为管理员或普通成员
  - 我可以移除团队成员
  - 我可以转让团队负责人权限

**故事19**: 作为一个**普通用户**，我希望能够通过邀请链接快速加入团队，以便简化加入流程。
- **验收标准**:
  - 我可以点击邀请链接直接加入团队
  - 链接有效期内可以正常使用
  - 过期链接显示相应提示
  - 加入成功后自动跳转到团队页面

**故事20**: 作为一个**团队成员**，我希望能够主动退出团队，以便在不需要时离开。
- **验收标准**:
  - 我可以在团队设置中选择退出团队
  - 系统会确认我的退出操作
  - 退出后我失去团队相关权限
  - 团队管理员会收到退出通知

### 3.6 系统管理相关故事

**故事21**: 作为一个**超级管理员**，我希望能够管理所有用户账户，以便维护系统秩序。
- **验收标准**:
  - 我可以查看所有用户列表
  - 我可以编辑任何用户的信息
  - 我可以禁用或启用用户账户
  - 我可以重置用户密码
  - 我可以删除用户账户

**故事22**: 作为一个**系统管理员**，我希望能够查看系统运行状态和日志，以便监控系统健康。
- **验收标准**:
  - 我可以查看系统关键指标
  - 我可以查看用户操作日志
  - 我可以查看错误日志
  - 我可以导出日志数据

## 4. 非功能性需求

### 4.1 性能需求
- 登录响应时间应小于2秒
- 页面加载时间应小于3秒
- 系统应支持1000+并发用户
- 数据库查询应进行优化

### 4.2 安全需求
- 密码必须加密存储
- 使用JWT进行身份认证
- 防止SQL注入攻击
- 防止XSS和CSRF攻击
- 记录敏感操作日志


## 5. 验收标准总结

每个用户故事都应该满足以下通用验收标准：
- 功能按预期工作
- 界面友好易用
- 响应时间符合要求
- 错误处理得当
- 安全性得到保障
- 兼容性良好

## 6. 优先级划分

### 高优先级（MVP功能）
- 用户注册和登录
- 基础权限控制
- 团队创建和加入
- 用户个人中心

### 中优先级
- 完整的RBAC权限系统
- 团队成员管理
- 邀请和审批流程

### 低优先级
- 高级安全功能
- 系统监控和日志
- 多语言支持
- 高级团队功能